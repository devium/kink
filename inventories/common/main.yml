stage: "{{ lookup('env', 'ANSIBLE_STAGE') }}"

terraform_servers_workspace: "{{ stage }}"
terraform_servers_hcloud_token: "{{ hcloud_token }}"
terraform_servers_hdns_token: "{{ hdns_token }}"
terraform_servers_hdns_zone_id: "{{ hdns_zone_id }}"
terraform_servers_domain: "{{ domain }}"
terraform_servers_subdomains: "{{ subdomains }}"
terraform_servers_ssh_key: "{{ ssh_key }}"

netplan_remove_existing: false
netplan_config_file: /etc/netplan/60-floating-ip.yaml
netplan_configuration:
  network:
   version: 2
   renderer: networkd
   ethernets:
     eth0:
       addresses:
       - "{{ ansible_host }}/32"
       - "{{ ipv6_address }}/64"
       - "{{ floating_ip.ipv4_address }}/32"
       - "{{ floating_ip.ipv6_address }}/64"

rke2_version: v1.22.6+rke2r1
rke2_download_kubeconf: true
rke2_download_kubeconf_path: "{{ ansible_inventory_sources[0] | dirname }}"
rke2_download_kubeconf_file_name: rke2.yaml

terraform_cluster_workspace: "{{ stage }}"
terraform_cluster_kubeconf_file: "{{ rke2_download_kubeconf_path }}/{{ rke2_download_kubeconf_file_name }}"
terraform_cluster_hcloud_token: "{{ hcloud_token }}"
terraform_cluster_floating_ipv4: "{{ floating_ip.ipv4_address }}"
terraform_cluster_domain: "{{ domain }}"
terraform_cluster_subdomains: "{{ subdomains }}"
terraform_cluster_use_production_cert: "{{ stage == 'prod' }}"
terraform_cluster_cert_email: "{{ cert_email }}"
terraform_cluster_db_root_password: "{{ db_root_password }}"
terraform_cluster_postgres_volume_handle: "{{ postgres_volume_handle }}"

terraform_cluster_versions:
  jitsi: stable-6865
  jitsi_helm: v1.0.0
  hcloud_csi: v1.6.0
  cert_manager_helm: v1.7.1
  postgres: 14.1.0-debian-10-r80
